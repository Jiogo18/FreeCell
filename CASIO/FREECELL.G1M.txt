'FREECELL'Par Jerome L'V 1.1AxesOff0→S"Charger la partie "?→SClrTextIf S=1Then Goto PIfEnd'+RESETClrGraph""→Str 1""→Str 2""→Str 3""→Str 4""→Str 5""→Str 6""→Str 7""→Str 8""→Str 9For 1→A To 52A<10⇒Str 9+"0"→Str 9For 1+Int log A→B To 1 Step -1Str 9+StrMid("0123456789",1+Int (10Frac (A/10^B)),1)→Str 9NextNext{2,2}→Dim Mat A0→Mat A[1,1]1→Mat A[2,1]0→θ0→A~Z:'-RESET'+AFFICHAGEViewWindow 1,127,1,63,1,1For 7→Y To 55 Step 6F-Line 20,Y,100,YNextFor 20→X To 100 Step 5F-Line X,7,X,55NextText 55,123,"%"For 21→A To 51 Step 5For 8→B To 50 Step 6Text 55,115,100-Int (StrLen(Str 9)/1.04)If StrLen(Str 9)≠2Then RanInt#(1,StrLen(Str 9)/2)*2-1→CElse 1→CIfEndStrMid(Str 9,C,2)→Str 10StrLeft(Str 9,C-1)+StrRight(Str 9,StrLen(Str 9)-C-1)→Str 90→DFor 1→C To StrLen(Str 10)(StrSrc("0123456789",StrMid(Str 10,C,1))-1)*(10^(StrLen(Str 10)-C))+D→DNextPxlOn B,AWhile D>13D-13→DPxlChg B+3,A+1PxlTest(B+3,A+1)=0⇒PxlOn B+3,A+2WhileEndD>7⇒PxlOn B+1,A+2D>7⇒D-8→DD>3⇒PxlOn B+2,A+2D>3⇒D-4→DD>1⇒PxlOn B+1,A+1D>1⇒D-2→DD=1⇒PxlOn B+2,A+1A=51⇒B=26⇒BreakNextNext""→Str 9Text 55,115,"   "Text 29,11,"■"For 4→Y To 58 Step 6F-Line 9,Y,15,YNextPxlOn 14,11PxlOn 20,12PxlOn 26,11PxlOn 26,120→A~Z:'-AFFICHAGELbl T:'+TASFor 1→A To 4A=1⇒I→BA=2⇒J→BA=3⇒K→BA=4⇒L→BPxlOff A*6,12PxlOff A*6+1,12PxlOff A*6,11PxlOff A*6+1,11B>7⇒PxlOn A*6,12B>7⇒B-8→BB>3⇒PxlOn A*6+1,12B>3⇒B-4→BB>1⇒PxlOn A*6,11B>1⇒B-2→BB=1⇒PxlOn A*6+1,11NextI+J+K+L=52⇒Goto G'-TAS'+TAILLEFor 1→A To 80→BWhile PxlTest(A*6+2,B*5+21)=1B+1→BWhileEndA=1⇒B→UA=2⇒B→VA=3⇒B→WA=4⇒B→PA=5⇒B→QA=6⇒B→RA=7⇒B→MA=8⇒B→NNext'-TAILLE1→AFor 8→Y To 50 Step 6Text Y,105," "NextFor 35→Y To 53 Step 6Text Y,4," "NextText 8,105,"►"If Mat A[1,1]=Mat A[2,1]Then Mat A[2,1]+1→Mat A[2,1]Augment(Mat A,[[0][0]])→Mat AIfEndθ=1⇒Goto θLbl S:'+SELECTEURText 1,120," "0→θDo:LpWhile Getkey≠0StoPict 1Do:LpWhile Getkey=0GetkeyAns=77⇒Goto θAns=71⇒Goto PAns=47⇒Goto AAns=37⇒A+1→AAns=28⇒A-1→A72≤Ans⇒Ans≤74⇒(Ans-72)*3+1→A62≤Ans⇒Ans≤64⇒(Ans-62)*3+2→A52≤Ans⇒Ans≤54⇒(Ans-52)*3+3→AA>12⇒1→AA<1⇒12→AIf Ans=37 Or Ans=28 Or (72≤Ans And Ans≤74) Or (62≤Ans And Ans≤64) Or (52≤Ans And Ans≤54)Then For 8→Y To 50 Step 6Text Y,105," "NextFor 35→Y To 53 Step 6Text Y,4," "NextIf A>8Then Text (A-8)*6+29,4,"◀"Else Text A*6+2,105,"►"IfEndIfEndAns=78⇒Goto RAns≠31⇒Goto S'-SELECTEUR1→BText 8,110,"◀"Lbl C:'+SELECTEUR 2Do:LpWhile Getkey≠0Do:LpWhile Getkey=0GetkeyIf B>8Then Text (B-8)*6+29,1," "Else Text B*6+2,110," "IfEndAns=47⇒Goto SAns=37⇒B+1→BAns=28⇒B-1→B72≤Ans⇒Ans≤74⇒(Ans-72)*3+1→B62≤Ans⇒Ans≤64⇒(Ans-62)*3+2→B52≤Ans⇒Ans≤54⇒(Ans-52)*3+3→BB>12⇒1→BB<1⇒12→BIf Ans=37 Or Ans=28 Or (72≤Ans And Ans≤74) Or (62≤Ans And Ans≤64) Or (52≤Ans And Ans≤54)Then For 8→Y To 50 Step 6Text Y,110," "NextFor 35→Y To 53 Step 6Text Y,1," "NextIf B>8Then Text (B-8)*6+29,1,"▸"Else Text B*6+2,110,"◀"IfEndIfEndAns≠31⇒Goto CA=B⇒Goto SA>8⇒B>8⇒Goto SB=1⇒U=16⇒Goto SB=2⇒V=16⇒Goto SB=3⇒W=16⇒Goto SB=4⇒P=16⇒Goto SB=5⇒Q=16⇒Goto SB=6⇒R=16⇒Goto SB=7⇒M=16⇒Goto SB=8⇒N=16⇒Goto S'-SELECTEUR 2'+DEPLACE1→CIf A<9Then A=1⇒U→EA=2⇒V→EA=3⇒W→EA=4⇒P→EA=5⇒Q→EA=6⇒R→EA=7⇒M→EA=8⇒N→EPxlTest(A*6+5,E*5+18)⇒3→CPxlTest(A*6+5,E*5+17)⇒C+1→CElse PxlTest((A-8)*6+32,12)⇒3→CPxlTest((A-8)*6+32,11)⇒C+1→CIfEndIf A<9Then PxlTest(A*6+3,E*5+18)*8+PxlTest(A*6+4,E*5+18)*4+PxlTest(A*6+3,E*5+17)*2+PxlTest(A*6+4,E*5+17)→GElse A-8→APxlTest(A*6+30,12)*8+PxlTest(A*6+31,12)*4+PxlTest(A*6+30,11)*2+PxlTest(A*6+31,11)→GA+8→AIfEndIf B<9Then 1→DB=1⇒U→FB=2⇒V→FB=3⇒W→FB=4⇒P→FB=5⇒Q→FB=6⇒R→FB=7⇒M→FB=8⇒N→FPxlTest(B*6+5,F*5+18)⇒3→DPxlTest(B*6+5,F*5+17)⇒D+1→DIf F≠0Then If D=1 Or D=4Then C=1 Or C=4⇒Goto SElse C=2 Or C=3⇒Goto SIfEndIfEndPxlTest(B*6+3,F*5+18)*8+PxlTest(B*6+4,F*5+18)*4+PxlTest(B*6+3,F*5+17)*2+PxlTest(B*6+4,F*5+17)→HIf G+1=H Or F=0Then Mat A[1,1]+1→Mat A[1,1]A→Mat A[1,Mat A[1,1]+1]B→Mat A[2,Mat A[1,1]+1]If A<9Then Text A*6+2,E*5+16," "For 1→Z To 5PxlOn A*6+7,E*5+15+ZNextElse A-8→AText A*6+29,10," "For 1→Z To 5PxlOn A*6+34,9+ZNextA+8→AIfEndPxlOn B*6+2,F*5+21C≥3⇒PxlOn B*6+5,F*5+23C=2 Or C=4⇒PxlOn B*6+5,F*5+22G>7⇒PxlOn B*6+3,F*5+23G>7⇒G-8→GG>3⇒PxlOn B*6+4,F*5+23G>3⇒G-4→GG>1⇒PxlOn B*6+3,F*5+22G>1⇒G-2→GG=1⇒PxlOn B*6+4,F*5+22Goto TIfEndElse If PxlTest((B-8)*6+29,10)=0Then Mat A[1,1]+1→Mat A[1,1]A→Mat A[1,Mat A[1,1]+1]B→Mat A[2,Mat A[1,1]+1]If A<9Then Text A*6+2,E*5+16," "For 1→Z To 5PxlOn A*6+7,E*5+15+ZNextIfEndPxlOn (B-8)*6+29,10C≥3⇒PxlOn (B-8)*6+32,12C=2 Or C=4⇒PxlOn (B-8)*6+32,11G>7⇒PxlOn (B-8)*6+30,12G>7⇒G-8→GG>3⇒PxlOn (B-8)*6+31,12G>3⇒G-4→GG>1⇒PxlOn (B-8)*6+30,11G>1⇒G-2→GG=1⇒PxlOn (B-8)*6+31,11Goto TIfEndIfEndGoto T:'-DEPLACE'+GO TASWhile 0Lbl R1→CIf A<9Then A=1⇒U→BA=2⇒V→BA=3⇒W→BA=4⇒P→BA=5⇒Q→BA=6⇒R→BA=7⇒M→BA=8⇒N→BPxlTest(A*6+5,B*5+18)⇒3→CPxlTest(A*6+5,B*5+17)⇒C+1→CElse PxlTest((A-8)*6+32,12)⇒3→CPxlTest((A-8)*6+32,11)⇒C+1→CIfEndC=1⇒I→DC=2⇒J→DC=3⇒K→DC=4⇒L→DIf A<9Then PxlTest(A*6+3,B*5+18)*8+PxlTest(A*6+4,B*5+18)*4+PxlTest(A*6+3,B*5+17)*2+PxlTest(A*6+4,B*5+17)→EIf E=D+1Then D+1→DMat A[1,1]+1→Mat A[1,1]A→Mat A[1,Mat A[1,1]+1]C+12→Mat A[2,Mat A[1,1]+1]Text A*6+2,B*5+16," "For 1→Z To 5PxlOn A*6+7,B*5+15+ZNextIfEndElse A-8→APxlTest(A*6+30,12)*8+PxlTest(A*6+31,12)*4+PxlTest(A*6+30,11)*2+PxlTest(A*6+31,11)→EIf E=D+1Then D+1→DMat A[1,1]+1→Mat A[1,1]A+8→Mat A[1,Mat A[1,1]+1]C+12→Mat A[2,Mat A[1,1]+1]Text A*6+29,10," "For 1→Z To 5PxlOn A*6+34,9+ZNextIfEndA+8→AIfEndC=1⇒D→IC=2⇒D→JC=3⇒D→KC=4⇒D→LGoto TWhileEnd'-GO TAS'+CANCELWhile 0Lbl AMat A[1,1]=0⇒Goto SMat A[1,Mat A[1,1]+1]→A:0→Mat A[1,Mat A[1,1]+1]Mat A[2,Mat A[1,1]+1]→B:0→Mat A[2,Mat A[1,1]+1]If B>12Then B-12→CC=1⇒I→HC=1⇒I-1→IC=2⇒J→HC=2⇒J-1→JC=3⇒K→HC=3⇒K-1→KC=4⇒L→HC=4⇒L-1→LElse 1→CIf B>8Then PxlTest((B-8)*6+32,12)⇒3→CPxlTest((B-8)*6+32,11)⇒C+1→CB-8→BPxlTest(B*6+30,12)*8+PxlTest(B*6+31,12)*4+PxlTest(B*6+30,11)*2+PxlTest(B*6+31,11)→HText B*6+29,10," "For 1→Z To 5PxlOn B*6+34,9+ZNextB+8→BElse B=1⇒U→EB=2⇒V→EB=3⇒W→EB=4⇒P→EB=5⇒Q→EB=6⇒R→EB=7⇒M→EB=8⇒N→EPxlTest(B*6+5,E*5+18)⇒3→CPxlTest(B*6+5,E*5+17)⇒C+1→CPxlTest(B*6+3,E*5+18)*8+PxlTest(B*6+4,E*5+18)*4+PxlTest(B*6+3,E*5+17)*2+PxlTest(B*6+4,E*5+17)→HText B*6+2,E*5+16," "For 1→Z To 5PxlOn B*6+7,E*5+15+ZNextIfEndIfEndIf A>8Then PxlOn (A-8)*6+29,10C≥3⇒PxlOn (A-8)*6+32,12C=2 Or C=4⇒PxlOn (A-8)*6+32,11H>7⇒PxlOn (A-8)*6+30,12H>7⇒H-8→HH>3⇒PxlOn (A-8)*6+31,12H>3⇒H-4→HH>1⇒PxlOn (A-8)*6+30,11H>1⇒H-2→HH=1⇒PxlOn (A-8)*6+31,11Else A=1⇒U→FA=2⇒V→FA=3⇒W→FA=4⇒P→FA=5⇒Q→FA=6⇒R→FA=7⇒M→FA=8⇒N→FPxlOn A*6+2,F*5+21C≥3⇒PxlOn A*6+5,F*5+23C=2 Or C=4⇒PxlOn A*6+5,F*5+22H>7⇒PxlOn A*6+3,F*5+23H>7⇒H-8→HH>3⇒PxlOn A*6+4,F*5+23H>3⇒H-4→HH>1⇒PxlOn A*6+3,F*5+22H>1⇒H-2→HH=1⇒PxlOn A*6+4,F*5+22IfEndMat A[1,1]-1→Mat A[1,1]Goto TWhileEnd'-CANCELLbl P'+PAUSEIf S=1Then ClrGraphRclPict 10→SIfEndDoClrTextLocate 17,7,"(123)""Reprendre "?→OLpWhile O≠123PxlOff 1,1Goto T'-PAUSE'+AUTOLbl θText 1,120,"A"1→θFor 1→A To 12Do1→E1→CIf A<9Then A=1⇒U→EA=2⇒V→EA=3⇒W→EA=4⇒P→EA=5⇒Q→EA=6⇒R→EA=7⇒M→EA=8⇒N→EPxlTest(A*6+5,E*5+18)⇒3→CPxlTest(A*6+5,E*5+17)⇒C+1→CPxlTest(A*6+3,E*5+18)*8+PxlTest(A*6+4,E*5+18)*4+PxlTest(A*6+3,E*5+17)*2+PxlTest(A*6+4,E*5+17)→GElse A-8→APxlTest(A*6+32,12)⇒3→CPxlTest(A*6+32,11)⇒C+1→CPxlTest(A*6+30,12)*8+PxlTest(A*6+31,12)*4+PxlTest(A*6+30,11)*2+PxlTest(A*6+31,11)→GA+8→AIfEndE=0⇒A+1→AA>12⇒BreakLpWhile E=0A>12⇒BreakC=1⇒I→HC=2⇒J→HC=3⇒K→HC=4⇒L→HG=H+1⇒Goto RNextGoto S'-AUTO'+GAGNELbl GFor 96→B To 21 Step -5B=92⇒93→BFor 8→A To 50 Step 6A=50⇒49→AB<96⇒Text A,B,"  "B=96⇒Text A,B," "NextNextText 17,39,"Game Over !"Text 33,35,"Termine en :"Mat A[1,1]→AText 40,42,AText 40,58,"coups"ClrMat 0→B~ZPxlOff 1,1'-GAGNE